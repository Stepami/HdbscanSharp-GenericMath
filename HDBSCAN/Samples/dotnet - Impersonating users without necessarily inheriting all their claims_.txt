Impersonating users without necessarily inheriting all their claims.
In my app, I have three permissions levels for users outside my organization, basically admin, manager, and user within each external organization. In order to allow Billy CEO to hand off use of the app to his executive assistant, I allow users to set designees. I'd like designees to be able to impersonate the user, but I want the designator to have the option of allowing the designee to inherit roles/claims from the designator. I found this on impersonating users. I'm wondering, can I remove roles/claims from the impersonated user for the duration of a session without necessarily removing the roles/claims altogether? The way I'm thinking about it is this: Sign in as the impersonated user. Check claims on the impersonating user to see if he/she inherits permissions. If no, remove permissions down to the level of the impersonator.  (It might happen in a different order in the code to make it simpler) The idea here is that sometimes we might want an assistant to handle someone's personal business, but if that person is a manager, the assistant ought not to do any management while impersonating. I'm reading elsewhere that this might not be possible and that I have to manage this with claims, but I don't want to insert a bunch more checks for claims into my program. If there's an elegant way to handle this, I'm all for it -- please let me know! Thanks.  submitted by /u/Socrathustra [link] [comments] 