I need help...using variable from PowerShell embedded resource file in C#
Hey guys, I'm new to C# and need some help. I am trying to take a powershell script that I have embedded as a resource file in visual studio, load the script into memory in c#, and be able to take the values out of a powershell array variable defined in the script and use it to populate a combobox for my wpf application. Could you possibly send me a sample snippet that could accomplish this, including any using statements that I may need to use? Here is a sample c# script that I tried which didn't work. I was writing this as a console application first just so I could write my variable to the screen to test if it works before assigning the finished product to my actual wpf combobox : using System; using System.Collections.Generic; using System.Collections.ObjectModel; using System.Linq; using System.Text; using System.Threading.Tasks; using System.Management.Automation; using System.Management.Automation.Runspaces; using System.IO; using System.DirectoryServices; namespace ConsoleApp3 { class Program { static void Main(string[] args) { //Read powershell resource file Stream st = new MemoryStream(Properties.Resources.GSVsample); StreamReader sr = new StreamReader(st); string script = sr.ReadToEnd();   Runspace runSpace = RunspaceFactory.CreateRunspace(); runSpace.Open(); Pipeline pipeline = runSpace.CreatePipeline(); Command cmd = new Command(script, true); pipeline.Commands.Add(cmd); Collection output = pipeline.Invoke(); foreach (PSObject psObject in output) { Console.WriteLine(psObject); } } }   } here are the contents of my embedded powershell resource file that I am calling: $global:service = (gsv).DisplayName | select -First 10  submitted by /u/hou8182 [link] [comments] 