Regenerate same results with Torch and Keras/TF, on Resnet model
I am trying to produce the same results with a pre-trained RESNET-50 using Torch and Keras (also tried tensorflow). My problem to solve is feature extraction from RESNET after spatial average pooling layer and before the softmax layer. When using torch I get perfect results, but when using Keras or Tensorflow (TF), I get feature vectors which are absurd (as per ROC curve calculations). A lot of feature vector values are predicted to exactly 0. (Difference shown in code) I have tried it with and without different preprocessing schemes, features extracted from Keras and TF implementations don't seem to make any sense, while the same preprocessing works good in classification examples ( when run the example code found in projects ). I have simplified and minimized the code to demonstrate my problem, it can be found here: Torch (this is what is expected): https://github.com/Shubhamcl/torch_vs_kerasTF/blob/master/torch.ipynb Keras with tf backend (this is what fails): https://github.com/Shubhamcl/torch_vs_kerasTF/blob/master/keras_tf.ipynb  submitted by /u/handsoncheeks [link] [comments] 